<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>no2forms poll — Just say no 2…</title>
  <meta name="description" content="Join the no2forms poll and vote for the thing you’d most like to say no 2." />
  <meta property="og:title" content="no2forms poll" />
  <meta property="og:description" content="Vote for what you want to say no 2." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://no2forms.com/poll" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { color-scheme: light dark; }
    html, body { height: 100%; }
    body { font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
    .focus-ring:focus { outline: none; box-shadow: 0 0 0 .2rem rgba(255,255,255,.2), 0 0 0 .4rem rgba(217,70,239,.45); }
    .glow { filter: blur(80px) saturate(90%); opacity: .28; }
  </style>
</head>
<body class="min-h-full bg-zinc-950 text-zinc-100">
  <!-- background glows -->
  <div class="pointer-events-none fixed inset-0 -z-10">
    <div class="glow absolute -top-24 left-1/2 h-[40rem] w-[40rem] -translate-x-1/2 rounded-full bg-fuchsia-500/40"></div>
    <div class="glow absolute top-1/3 right-1/4 h-[28rem] w-[28rem] rounded-full bg-indigo-500/40"></div>
  </div>

  <header class="relative">
    <div class="mx-auto max-w-7xl px-6 py-5 flex items-center justify-between">
      <a href="index.html" class="flex items-center gap-3">
        <div class="h-9 w-9 rounded-2xl bg-gradient-to-br from-fuchsia-500 to-indigo-500 shadow-lg"></div>
        <span class="text-lg font-semibold tracking-tight">no2forms</span>
      </a>
      <nav class="hidden md:flex items-center gap-6 text-sm text-zinc-300">
        <a class="hover:text-white transition" href="index.html#benefits">Benefits</a>
        <a class="hover:text-white transition" href="index.html#how">How it works</a>
        <a class="hover:text-white transition" href="index.html#pricing">Pricing</a>
        <a class="hover:text-white transition" href="index.html#faq">FAQ</a>
        <a class="hover:text-white transition" href="poll.html">Poll</a>
      </nav>
    </div>
  </header>

  <main class="px-6">
    <div class="mx-auto max-w-5xl pt-20 pb-16 text-center">
      <h1 class="text-3xl sm:text-5xl font-extrabold leading-tight tracking-tight">The no2forms poll</h1>
      <p class="mt-4 text-lg sm:text-xl text-zinc-300 max-w-3xl mx-auto">Have your say! What should we all just say no 2? Vote below or add your own.</p>
    </div>
    <div class="mx-auto max-w-5xl">
      <div class="rounded-3xl border border-zinc-800/60 bg-zinc-900/40 p-6 sm:p-8">
        <div class="flex items-center justify-between gap-4">
          <h2 class="text-2xl sm:text-3xl font-bold">Cast your vote</h2>
          <span class="hidden sm:inline text-xs text-zinc-400">Votes are saved server‑side</span>
        </div>
        <div class="mt-4 flex flex-col sm:flex-row items-center gap-2">
          <input id="poll-input" type="text" inputmode="text" placeholder="Add your own…" class="flex-1 rounded-xl bg-zinc-900/50 border border-zinc-800/60 px-3 py-2 text-sm text-zinc-200 placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-fuchsia-600/40" />
          <button id="poll-add" class="rounded-2xl border border-zinc-700/70 px-3 py-2 text-sm text-zinc-200 hover:border-zinc-500 hover:bg-zinc-900/40 transition focus-ring">Add</button>
        </div>
        <div id="poll-list" class="mt-6 grid sm:grid-cols-2 gap-3"></div>
        <div class="mt-6 text-xs text-zinc-400" id="poll-stats"></div>
      </div>
    </div>
  </main>

  <footer class="relative mt-12">
    <div class="mx-auto max-w-7xl px-6 py-12 flex flex-col sm:flex-row items-center justify-between gap-4 text-sm text-zinc-400">
      <div>© <span id="year"></span> no2forms</div>
      <div class="flex items-center gap-4">
        <a class="hover:text-white" href="mailto:hello@no2forms.com">Contact</a>
        <a class="hover:text-white" href="#">Privacy</a>
      </div>
    </div>
  </footer>

  <script>
  document.getElementById('year').textContent = new Date().getFullYear();
  // Simple poll client that interacts with /api/poll
  (function(){
    const listEl = document.getElementById('poll-list');
    const statsEl = document.getElementById('poll-stats');
    const inputEl = document.getElementById('poll-input');
    const addBtn = document.getElementById('poll-add');
    // track user votes to prevent repeated votes in this session
    let myVotes = new Set(JSON.parse(localStorage.getItem('n2f-myVotes') || '[]'));

    function saveMyVotes(){ localStorage.setItem('n2f-myVotes', JSON.stringify(Array.from(myVotes))); }

    async function load() {
      try {
        const res = await fetch('/api/poll');
        const data = await res.json();
        render(data);
      } catch (err) {
        console.error('poll load error', err);
      }
    }

    async function vote(label) {
      try {
        const res = await fetch('/api/poll', {
          method: 'POST',
          headers: { 'content-type': 'application/json' },
          body: JSON.stringify({ label })
        });
        const data = await res.json();
        if (data && data.ok) {
          myVotes.add(label.toLowerCase());
          saveMyVotes();
          render(data.poll);
        }
      } catch (err) {
        console.error('vote error', err);
      }
    }

    function render(poll) {
      // poll is an object: {label: votes}
      const entries = Object.entries(poll);
      // sort by votes desc then label
      entries.sort((a,b) => (b[1] - a[1]) || a[0].localeCompare(b[0]));
      listEl.innerHTML = '';
      let total = 0;
      entries.forEach(([label, votes]) => { total += votes; });
      entries.forEach(([label, votes]) => {
        const pct = total ? Math.round((votes / total) * 100) : 0;
        const voted = myVotes.has(label.toLowerCase());
        const row = document.createElement('div');
        row.className = "relative overflow-hidden rounded-2xl border border-zinc-800/60 bg-zinc-900/40 p-4 hover:border-fuchsia-600/40 transition";
        row.innerHTML = `
          <div class="flex items-center justify-between gap-3">
            <button data-label="${label}" class="vote-btn inline-flex items-center gap-2 rounded-xl px-3 py-2 text-sm
              ${voted ? 'bg-gradient-to-r from-fuchsia-500/90 to-indigo-500/90 text-white' : 'bg-zinc-800/60 text-zinc-200'}
              hover:scale-[1.02] active:scale-[.98] transition focus-ring">
              <span>${voted ? '✅' : '➕'}</span>
              <span>say no 2 “${label.replace(/"/g,'&quot;')}”</span>
            </button>
            <div class="text-sm text-zinc-300 tabular-nums"><span class="font-semibold">${votes}</span> votes</div>
          </div>
          <div class="mt-3 h-2 w-full rounded-full bg-zinc-800/70">
            <div class="h-2 rounded-full bg-gradient-to-r from-fuchsia-500 to-indigo-500" style="width:${pct}%;"></div>
          </div>
          <div class="mt-2 text-xs text-zinc-400">${pct}% of votes</div>
        `;
        listEl.appendChild(row);
      });
      statsEl.textContent = `${entries.length} options • ${total} total votes`;
    }

    listEl.addEventListener('click', (e) => {
      const btn = e.target.closest('.vote-btn');
      if (!btn) return;
      const label = btn.getAttribute('data-label');
      const lower = label.toLowerCase();
      if (myVotes.has(lower)) return; // prevent re‑voting
      vote(label);
    });
    addBtn.addEventListener('click', () => {
      const v = (inputEl.value || '').trim();
      if (!v) return;
      vote(v);
      inputEl.value = '';
    });
    inputEl.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        const v = (inputEl.value || '').trim();
        if (!v) return;
        vote(v);
        inputEl.value = '';
      }
    });
    // initial load
    load();
  })();
  </script>
</body>
</html>
